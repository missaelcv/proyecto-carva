<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Probando Canvas</title>
    <style>
        canvas {
            border: 1px solid gray;
            margin: auto;
            display: block;
        }
        img {
            display: none;
        }
    </style>
</head>
<body>
    <canvas id="miCanvas" width="800" height="300"></canvas>

    <img src="imagenes/gato1.png" alt="" id="gato1">
    <img src="imagenes/gato2.png" alt="" id="gato2">
    <img src="imagenes/gato3.png" alt="" id="gato3">
    <img src="imagenes/gato4.png" alt="" id="gato4">
    <img src="imagenes/gato5.png" alt="" id="gato5">
    <img src="imagenes/gato6.png" alt="" id="gato6">
    <img src="imagenes/gato7.png" alt="" id="gato7">
    <img src="imagenes/gato8.png" alt="" id="gato8">
    <script>
        let miCanvas = document.getElementById("miCanvas");
        let contexto = miCanvas.getContext("2d");
        let anchura = miCanvas.width;
        let altura = miCanvas.height;

        function gradosARadianes( grados ) {
            return grados * (Math.PI/180);
        }

        //1 - Dibujar Cuadricula
        function dibujarCuadricula( variacion = 20 ) {
            for( let x = variacion; x < anchura; x += variacion) {
                crearLinea({x, y:0}, {x, y: altura}).dibujar();
            }

            for( let y = variacion; y < altura; y += variacion) {
                crearLinea({x:0, y}, {x:anchura, y}).dibujar();
            }
        }

        //4- Dibujar una imagen
        let imagenActual = 1, imagen = document.getElementById(`gato${ imagenActual }`),
         anchuraImagen = imagen.width, alturaImagen = imagen.height;
         let estaCreciendo = false;

         imagen.onload = dibujarImagen;

        function dibujarImagen() {
            anchuraImagen = imagen.width;
            alturaImagen = imagen.height;
            let posicionHorizontal = 0;
            let posicionVertical = 0;
            let tiempo = 60;
            let xInicial = 0;
            let tamanioMinimoImagen = 60;
            let tamanioMaximoImagen = 500;
            setInterval( () => {
                imagen = document.getElementById(`gato${ imagenActual }`);
                console.log(imagenActual);
                console.log("anchuraImagen: ", anchuraImagen);
                console.log("alturaImagen: ", alturaImagen);
                
                contexto.beginPath();
                contexto.fillStyle = "#eee";
                contexto.fillRect(0,0, anchura, altura);

                let variacionHorizontal = Math.round( Math.log2(tiempo) );
                console.log( "variacionHorizontal: ", variacionHorizontal );

                posicionHorizontal += variacionHorizontal;
                if(posicionHorizontal > anchura) {
                    posicionHorizontal = -anchuraImagen;
                }

                //dibujar lineas verticales para hacer mas realista el movimiento
                let variacion = anchuraImagen;
                for( let x = anchura - xInicial; x > 0 ; x -= variacion) {
                    contexto.beginPath();
                    contexto.moveTo( x, 0 );
                    contexto.lineTo( x, altura );
                    contexto.stroke();
                }

                xInicial += variacionHorizontal;
                if(xInicial > variacion) {
                    xInicial = 0;
                }

                anchuraImagen = anchuraImagen + (estaCreciendo ? 1 : -1);
                alturaImagen = alturaImagen + (estaCreciendo ? 1 : -1);

                posicionVertical = altura - alturaImagen;

                //dibujar una linea horizontal sobre la imagen para hacer aun mas realista el movimiento
                contexto.beginPath();
                contexto.moveTo( 0, posicionVertical );
                contexto.lineTo( anchura, posicionVertical );
                contexto.stroke();

                //dibujar el piso
                contexto.beginPath();
                contexto.fillStyle = "gray";
                contexto.fillRect(0,altura - 20, anchura, 20);

                //dibujar la imagen del gato
                contexto.drawImage(imagen, posicionHorizontal, posicionVertical, anchuraImagen, alturaImagen);
                
                if( anchuraImagen < tamanioMinimoImagen || alturaImagen < tamanioMinimoImagen) {
                    estaCreciendo = true;
                }

                if( anchuraImagen > tamanioMaximoImagen || alturaImagen > tamanioMaximoImagen) {
                    estaCreciendo = false;
                }

                imagenActual++
                if( imagenActual > 8) {
                    imagenActual = 1;
                }
            }, tiempo);
            
        }
    </script>
</body>
</html>